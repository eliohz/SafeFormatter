  <Window x:Class="SafeFormatter.Views.MainWindow"
          xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
          xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
          xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
          xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
          xmlns:viewModels="clr-namespace:SafeFormatter.ViewModels"
          mc:Ignorable="d"
          Title="SafeFormatter – SD/USB sicher vorbereiten"
          Height="720" Width="1080">
    <Window.DataContext>
      <viewModels:MainViewModel />
    </Window.DataContext>

    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="220"/>
      </Grid.RowDefinitions>

      <!-- Kopfzeile -->
      <DockPanel Margin="16">
        <TextBlock Text="Wechseldatenträger auswählen" FontSize="24" FontWeight="Bold"/>
        <Button Content="Aktualisieren" Command="{Binding RefreshCmd}" HorizontalAlignment="Right" DockPanel.Dock="Right"/>
      </DockPanel>

      <!-- Kacheln -->
      <ScrollViewer Grid.Row="1" Margin="16">
        <ItemsControl ItemsSource="{Binding Disks}">
          <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
              <WrapPanel />
            </ItemsPanelTemplate>
          </ItemsControl.ItemsPanel>
          <ItemsControl.ItemTemplate>
            <DataTemplate DataType="{x:Type viewModels:MainViewModel}">
              <Border Style="{StaticResource TileBorder}">
                <Grid>
                  <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                  </Grid.RowDefinitions>
                  <TextBlock Text="{Binding FriendlyName}" FontWeight="Bold" FontSize="18"/>
                  <TextBlock Grid.Row="1" Text="{Binding Model}"/>
                  <TextBlock Grid.Row="2" Text="{Binding SizeGb}"/>
                  <TextBlock Grid.Row="3" Text="{Binding Serial, StringFormat=Seriennummer: {0}}"/>
                </Grid>
              </Border>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
          <ItemsControl.ItemContainerStyle>
            <Style TargetType="ContentPresenter">
              <EventSetter Event="MouseLeftButtonUp" Handler="OnTileClicked"/>
            </Style>
          </ItemsControl.ItemContainerStyle>
        </ItemsControl>
      </ScrollViewer>

      <!-- Auswahl / Optionen -->
      <Grid Grid.Row="2" Margin="16">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Column="0" Orientation="Vertical">
          <TextBlock Text="Label (optional)"/>
          <TextBox Text="{Binding VolumeLabel, UpdateSourceTrigger=PropertyChanged}" AutomationProperties.Name="Volume Label"/>
        </StackPanel>

        <StackPanel Grid.Column="1" Orientation="Vertical" Margin="24,0">
          <TextBlock Text="Geplantes Dateisystem"/>
          <TextBlock Text="{Binding FsPreview}" FontWeight="Bold"/>
        </StackPanel>

        <StackPanel Grid.Column="2" Orientation="Vertical">
          <CheckBox Content="Ich verstehe, dass alle Daten auf dem ausgewählten Wechseldatenträger gelöscht werden."
                    IsChecked="{Binding Confirmed}"/>
          <TextBlock Text="Seriennummer:"/>
          <TextBlock Text="{Binding SerialDisplay}" FontWeight="Bold"/>
          <Button Content="Starten" Command="{Binding StartCmd}" HorizontalAlignment="Right"/>
        </StackPanel>
      </Grid>

      <!-- Fortschritt + Log -->
      <Grid Grid.Row="3" Margin="16">
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,0,8">
          <ProgressBar Width="400" Height="18" Value="{Binding Progress}" Maximum="1"/>
          <TextBlock Text="  "/>
          <TextBlock Text="Verstrichene Zeit: "/>
          <TextBlock Text="{Binding Elapsed}" FontWeight="Bold"/>
        </StackPanel>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
          <TextBox Text="{Binding LogText}" IsReadOnly="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Hidden" AcceptsReturn="True"/>
        </ScrollViewer>
      </Grid>
    </Grid>
  </Window>
